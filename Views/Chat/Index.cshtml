@{
    Layout = null;
    var currentUserId = HttpContextAccessor.HttpContext.Session.GetInt32("userId");
}
@using EbayChat.Models.DTOs;
@model List<BoxChatDTO>

<html>
<head>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/ChatIndex.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.js"></script>
    <script src="~/js/chat-logic.js"></script>

</head>
<body>
    <div class="chat-container">
        <div class="messaging">
            <div class="inbox_msg">
                @* Box chat start here  *@
                
                <div class="inbox_people">
                    <div class="headind_srch">
                        <div class="recent_heading">
                            <h4>Recent</h4>
                        </div>
                        @* Search bar start here *@
                        <div class="srch_bar">
                            <div class="stylish-input-group">
                                <input type="text" class="search-bar" placeholder="Search">
                                <span class="input-group-addon">
                                    <button type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
                                </span>
                            </div>
                        </div>
                        @* Search bar end here *@
                    </div>
                    @* All box chats *@
                    <div class="inbox_chat">
                        @* Box chat example 1 *@
                        @* <div class="chat_list active_chat">
                            <div class="chat_people">
                                <div class="chat_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                                <div class="chat_ib">
                                    <h5>Sunil Rajput 
                                        <span class="chat_date">Dec 25</span>
                                    </h5>
                                    <p>
                                        Test, which is a new approach to have all solutions
                                        astrology under one roof.
                                    </p>
                                </div>
                            </div>
                        </div> *@
                        @* Box chat example 2 *@
                        @* <div class="chat_list">
                            <div class="chat_people">
                                <div class="chat_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                                <div class="chat_ib">
                                    <h5>
                                        Sunil Rajput
                                        <span class="unread"></span>
                                        <span class="chat_date">Dec 25</span>
                                    </h5>
                                    <p>
                                        Test, which is a new approach to have all solutions
                                        astrology under one roof.
                                    </p>
                                </div>
                            </div>
                        </div> *@

                        @foreach(var boxChatItem in Model)
                        {
                            <div class="chat_list" onclick="selectUser(@currentUserId ,@boxChatItem.SenderId, @boxChatItem.ReceiverId, '@boxChatItem.Avatar')">
                                <div class="chat_people">
                                    <div class="chat_img"> <img class="rounded-circle" src="@boxChatItem.Avatar" alt="avatar"> </div>
                                    <div class="chat_ib">
                                        <h5>
                                            @boxChatItem.Name
                                            @if (boxChatItem.SenderId != currentUserId && !boxChatItem.Seen.GetValueOrDefault())
                                            {
                                                <span class="unread"></span>
                                            }
                                            <span class="chat_date">@boxChatItem.Time</span>
                                        </h5>
                                        <p>
                                            @boxChatItem.LastMessage
                                        </p>
                                    </div>
                                </div>
                            </div>
                        }

                    </div>
                </div>
                @* Right columns start here  *@

                @* Messages shown here  *@
                <div class="mesgs" id="chatArea">
                    <div class="welcome-screen" id="welcomeScreen">
                        <div class="welcome-screen-icon">💬</div>
                        <h2>Select a conversation</h2>
                        <p>Choose a contact to start messaging</p>
                    </div>

                    @* <div class="msg_history">
                        <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>
                                        Test which is a new approach to have all
                                        solutions
                                    </p>
                                    <span class="incoming_time_date"> 11:01 AM    |    June 9</span>
                                </div>
                            </div>
                        </div>

                        <div class="outgoing_msg">
                            <div class="sent_msg">
                                <p>
                                    Test which is a new approach to have all
                                    solutions
                                </p>
                                <span class="outgoing_time_date"> 11:01 AM | June 9</span>
                            </div>
                        </div>

                        <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>
                                        very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe hehehe very long content here hehehe hehehe very long content here hehehe hehehe very long content here hehehe
                                       
                                    </p>
                                    <span class="incoming_time_date"> 11:01 AM | Yesterday</span>
                                </div>
                            </div>
                        </div>

                        <div class="outgoing_msg">
                            <div class="sent_msg">
                                <p>
                                    very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe very long content here hehehe hehehe very long content here hehehe hehehe very long content here hehehe hehehe very long content here hehehe
                                </p>
                                <span class="outgoing_time_date"> 11:01 AM    |    Today</span>
                            </div>
                        </div>

                        <div class="incoming_msg">
                            <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                            <div class="received_msg">
                                <div class="received_withd_msg">
                                    <p>
                                        We work directly with our designers and suppliers,
                                        and sell direct to you, which means quality, exclusive
                                        products, at a price anyone can afford.
                                    </p>
                                    <span class="incoming_time_date"> 11:01 AM    |    Today</span>
                                </div>
                            </div>
                        </div>
                    </div> *@
                    
                    @* Typing area *@
                    @* <div class="type_msg">
                        <div class="input_msg_write">
                            <input type="text" class="write_msg" placeholder="Type a message" />
                            <button class="msg_send_btn" type="button"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
                        </div>
                    </div> *@
                </div>
            </div>
        </div>
    </div>
</body>
</html>